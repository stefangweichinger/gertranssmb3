<?xml version="1.0" encoding="ISO-8859-1"?>
<chapter id="AdvancedNetworkManagement">
<chapterinfo>
	&author.jht;
    <pubdate>April 3 2003</pubdate>
        <author>&person.sgw;<contrib>Deutsche Übersetzung</contrib></author>
</chapterinfo>

<title>Fortgeschrittenes Netzwerk-Management</title>

<para>
Dieser Abschnitt dokumentiert Randthemen, die sehr wichtig für Netzwerkadministratoren sind,
die die Zugriffskontrolle auf Netzwerk-Ressourcen verbessern wollen, die Benutzerumgebung
automatisieren, und ihr Leben ein wenig erleichtern wollen.
</para>

<sect1>
<title>Eigenschaften und Vorzüge</title>

<para>
Oft kann der Unterschied zwischen einer funktionierenden Netzwerkumgebung und einer als
gut wahr- und angenommenen am Besten durch die <emphasis>Kleinigkeiten</emphasis>
gemessen werden, die alles noch harmonischer arbeiten lassen. Eine Schlüsselrolle jeder
Netzwerklösung ist die Fähigkeit, per Fernzugriff MS Windows Workstations zu warten,
über das Netz auf den Samba-Server zugreifen zu können, angepasste Anmelde-Skripts zur
Verfügung zu stellen, genauso wie andere "Hausarbeiten", die helfen, verlässlicheren
Netzwerk-Betrieb zu erreichen.
</para>

<para>
Dieses Kapitel präsentiert Informationen zu jedem dieser Bereiche. Sie wurden hier, und
nicht in anderen Kapiteln, plaziert, um das Nachschlagen zu erleichtern.
</para>

</sect1>

<sect1>
<title>Server-Fernwartung</title>


<para><quote>Wie bekomme ich `User Manager' und `Server Manager'?</quote></para>

<para>
<indexterm><primary>User Manager</primary></indexterm>
<indexterm><primary>Server Manager</primary></indexterm>
<indexterm><primary>Event Viewer</primary></indexterm>
Da ich ja keinen <application>NT4 Server</application> kaufen muß, wie bekomme ich den
`User Manager for Domains' und den `Server Manager'?
</para>

<para>
<indexterm><primary>Nexus.exe</primary></indexterm>
Microsoft vertreibt eine Version dieser Tools namens <filename>Nexus.exe</filename>, zur
Installation auf <application>Windows 9x/Me</application>-Systemen. Dieses Set enthält:
</para>

<itemizedlist>
	<listitem>Server Manager</listitem>
	<listitem>User Manager for Domains</listitem>
	<listitem>Event Viewer</listitem>
</itemizedlist>

<para>
Laden Sie die Archivdatei von <ulink noescape="1" url="ftp://ftp.microsoft.com/Softlib/MSLFILES/NEXUS.EXE">ftp://ftp.microsoft.com/Softlib/MSLFILES/NEXUS.EXE.</ulink>
</para>

<para>
<indexterm><primary>SRVTOOLS.EXE</primary></indexterm>
Die <application>Windows NT 4.0</application> Version des `User Manager for 
Domains' und `Server Manager' sind via ftp bei Microsoft erhältlich <ulink url="ftp://ftp.microsoft.com/Softlib/MSLFILES/SRVTOOLS.EXE"></ulink>.
</para>

</sect1>

<sect1>
<title>Desktop-Fernwartung</title>

<para>
Es gibt eine Reihe von verfügbaren Desktop-Fernwartungs-Lösungen, die von gratis bis
teuer reichen. Lassen Sie sich davon nicht abhalten. Manchmal ist die teuerste Lösung
die kosten-effektivste. In jedem Fall müssen Sie Ihre eigenen Schlüsse ziehen, was die
beste Lösung für Ihr Netzwerk ist.
</para>

	<sect2>
	<title>Fernwartung von NoMachine.Com</title>

	<para>
	<indexterm><primary>NoMachine.Com</primary></indexterm>
	Folgende Informationen wurden auf der Samba mailing list am 3.4.2003, um 23:33:50 GMT
	gepostet. Sie werden in abgewandelter Form präsentiert (mit fehlenden Autor-Details
	wegen Datenschutz).
	Die gesamte Antwort wird (bis auf ein paar Kommentare) gezeigt.
	</para>

		<para><quote>
		Ich habe einen wunderbaren Linux/Samba-Server als PDC laufen. Jetzt würde ich gerne
		Fernwartungs-Funktionen hinzufügen, sodaß Benutzer sich am System anmelden, und ihren
		Desktop von zuhause aus, oder aus dem Ausland erreichen können.		
		</quote></para>

		<para><quote>
		Gibt es eine Möglichkeit, dies zu erreichen? Brauche ich einen Windows Terminal Server?
		Muß ich so konfigurieren, daß er Domänen-Mitglied ist, oder ein BDC, PDC? Gibt es
		irgendwelche hacks für Windows XP, um Fernzugriff zu aktivieren, auch wenn der Rechner
		in einer Domäne ist?
		</quote></para>

		<para>
		Gegebene Antwort: Prüfen Sie das neue Angebot von <quote>NX</quote>-Software von
		<ulink noescape="1" url="http://www.nomachine.com/">NoMachine</ulink>.
		</para>

	<para>
	Es implementiert ein leicht zu verwendendes Interface zum Remote-X-Protokoll genauso
	wie es VNC/RFB und rdesktop/RDP einschließt, dies jedoch mit einer Geschwindigkeit, wie
	sie sie wahrscheinlich noch nicht gesehen haben.
	</para>

	<para>
	Remote X ist bei weitem nicht neu, aber was hier erreicht wurde, ist eine neue Art von
	Kompressions- und Caching-Technologie, die diese Software sogar über langsame 
	Modem/ISDN-Strecken ausreichend schnell laufen läßt.
	</para>

	<para>
	Ich konnte ihre (öffentliche) RedHat-Maschine in Italien "testfahren", über eine
	belastete Internet-Verbindung, mit aktivierten Thumbnails im KDE Konqueror, welcher
	unverzüglich auf <quote>mouse-over</quote> ansprang. Von innerhalb dieser (remote X)
	Sitzung startete ich eine rdesktop-Sitzung auf eine weitere Windows XP Maschine.
	Um die Performance zu testen, spielte ich Pinball. Ich bin stolz, sagen zu dürfen,
	daß ich beim ersten Versuch 631750 Punkte erreichte.
	</para>

	<para>
	NX arbeitet in meinem LAN besser als die anderen <quote>reinen</quote> Verbindungsarten,
	die ich von Zeit zu Zeit benutze: TightVNC, rdesktop oder Remote X.
	Es ist sogar schneller als eine direkte Crosslink-Verbindung zwischen 2 Knoten.	
	</para>

	<para>
	Ich bekomme sogar Sound von der Remote-X-applikation auf meine lokalen Lautsprecher,
	und ich hatte ein funktionierendes <quote>copy'n'paste</quote> von einem NX-Fenster
	(in welchem eine KDE-Sitzung in Italien lief) in meinen Mozilla-Mail-Agenten. Diese
	Kerle machen definitiv etwas richtig!	
	</para>

	<para>
	Ich empfehle jedem, der auch nur ein nebensächliches Interesse an Fernwartung hat,
	NX auszuprobieren:	
	<ulink noescape="1" url="http://www.nomachine.com/testdrive.php">http://www.nomachine.com/testdrive.php</ulink>.
	</para>

	<para>
	Einfach den kostenlosen Client downloaden (verfügbar für Red Hat, SuSE, Debian
	und Windows) und innerhalb 5 Minuten geht es los (es müssen allerdings erst
	die Zugangsdaten gesendet werden, weil Sie einen vollen UNIX-account auf deren
	testdrive.nomachine.com-Box erhalten).
	</para>

	<para>
	Nomachine plant die Ausbaustufe, wo Sie NX-Applikations-Server als Cluster betreiben können,
	und die Benutzer starten einfach eine lokale NX-Session	und können



They plan to get to the point were you can have NX application servers
	running as a cluster of nodes, and users simply start an NX session locally,
	and can select applications to run transparently (apps may even run on
	another NX node, but pretend to be on the same as used for initial login,
	because it displays in the same window. You also can run it
	full-screen, and after a short time you forget that it is a remote session
	at all).
	</para>

	<para>
	Now the best thing for last: All the core compression and caching
	technologies are released under the GPL and available as source code
	to anybody who wants to build on it! These technologies are working,
	albeit started from the command line only (and very inconvenient to
	use in order to get a fully running remote X session up and running.)
	</para>

	<para>
	To answer your questions:
	</para>

	<itemizedlist>
		<listitem><para>
		You do not need to install a terminal server; XP has RDP support built in.
		</para></listitem>

		<listitem><para>
		NX is much cheaper than Citrix &smbmdash; and comparable in performance, probably faster.
		</para></listitem>

		<listitem><para>
		You do not need to hack XP &smbmdash; it just works.
		</para></listitem>

		<listitem><para>
		You log into the XP box from remote transparently (and I think there is no
		need to change anything to get a connection, even if authentication is against a domain).
		</para></listitem>

		<listitem><para>
		The NX core technologies are all Open Source and released under the GPL &smbmdash;
		you can now use a (very inconvenient) command-line at no cost,
		but you can buy a comfortable (proprietary) NX GUI front end for money.
		</para></listitem>

		<listitem><para>
		NoMachine are encouraging and offering help to OSS/Free Software implementations
		for such a front end too, even if it means competition to them (they have written
		to this effect even to the LTSP, KDE and GNOME developer mailing lists).
		</para></listitem>
	</itemizedlist>

	</sect2>

</sect1>

<sect1>
<title>Network Logon Script Magic</title>

<para>
There are several opportunities for creating a custom network startup configuration environment.
</para>

<itemizedlist>
	<listitem>No Logon Script.</listitem>
	<listitem>Simple universal Logon Script that applies to all users.</listitem>
	<listitem>Use of a conditional Logon Script that applies per user or per group attributes.</listitem>
	<listitem>Use of Samba's preexec and postexec functions on access to the NETLOGON share to create
	a custom logon script and then execute it.</listitem>
	<listitem>User of a tool such as KixStart.</listitem>
</itemizedlist>

<para>
The Samba source code tree includes two logon script generation/execution tools.
See <filename>examples</filename> directory <filename>genlogon</filename> and
<filename>ntlogon</filename> subdirectories.
</para>

<para>
The following listings are from the genlogon directory.
</para>


<para>
<indexterm><primary>genlogon.pl</primary></indexterm>
This is the <filename>genlogon.pl</filename> file:

<smbfile name="genlogon.pl">
<programlisting>
	#!/usr/bin/perl
	#
	# genlogon.pl
	#
	# Perl script to generate user logon scripts on the fly, when users
	# connect from a Windows client. This script should be called from 
	# smb.conf with the %U, %G and %L parameters. I.e:
	#
	#       root preexec = genlogon.pl %U %G %L
	#
	# The script generated will perform
	# the following:
	#
	# 1. Log the user connection to /var/log/samba/netlogon.log
	# 2. Set the PC's time to the Linux server time (which is maintained
	#    daily to the National Institute of Standards Atomic clock on the
	#    internet.
	# 3. Connect the user's home drive to H: (H for Home).
	# 4. Connect common drives that everyone uses.
	# 5. Connect group-specific drives for certain user groups.
	# 6. Connect user-specific drives for certain users.
	# 7. Connect network printers.

	# Log client connection
	#($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime(time);
	($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime(time);
	open LOG, ">>/var/log/samba/netlogon.log";
	print LOG "$mon/$mday/$year $hour:$min:$sec";
	print LOG " - User $ARGV[0] logged into $ARGV[1]\n";
	close LOG;

	# Start generating logon script
	open LOGON, ">/shared/netlogon/$ARGV[0].bat";
	print LOGON "\@ECHO OFF\r\n";

	# Connect shares just use by Software Development group
	if ($ARGV[1] eq "SOFTDEV" || $ARGV[0] eq "softdev")
	{
		print LOGON "NET USE M: \\\\$ARGV[2]\\SOURCE\r\n";
	}

	# Connect shares just use by Technical Support staff
	if ($ARGV[1] eq "SUPPORT" || $ARGV[0] eq "support")
	{
		print LOGON "NET USE S: \\\\$ARGV[2]\\SUPPORT\r\n";
	}

	# Connect shares just used by Administration staff
	If ($ARGV[1] eq "ADMIN" || $ARGV[0] eq "admin")
	{
		print LOGON "NET USE L: \\\\$ARGV[2]\\ADMIN\r\n";
		print LOGON "NET USE K: \\\\$ARGV[2]\\MKTING\r\n";
	}

	# Now connect Printers. We handle just two or three users a little
	# differently, because they are the exceptions that have desktop
	# printers on LPT1: - all other user's go to the LaserJet on the
	# server.
	if ($ARGV[0] eq 'jim'
	    || $ARGV[0] eq 'yvonne')
	{
		print LOGON "NET USE LPT2: \\\\$ARGV[2]\\LJET3\r\n";
		print LOGON "NET USE LPT3: \\\\$ARGV[2]\\FAXQ\r\n";
	}
	else
	{
		print LOGON "NET USE LPT1: \\\\$ARGV[2]\\LJET3\r\n";
		print LOGON "NET USE LPT3: \\\\$ARGV[2]\\FAXQ\r\n";
	}

	# All done! Close the output file.
	close LOGON;
</programlisting>
</smbfile>
</para>

<para>
Those wishing to use more elaborate or capable logon processing system should check out these sites:
</para>

<itemizedlist>
	<listitem><ulink noescape="1" url="http://www.craigelachie.org/rhacer/ntlogon">http://www.craigelachie.org/rhacer/ntlogon</ulink></listitem>
	<listitem><ulink noescape="1" url="http://www.kixtart.org">http://www.kixtart.org</ulink></listitem>
</itemizedlist>

<sect2>
<title>Adding Printers without User Intervention</title>


<para>
<indexterm><primary>rundll32</primary></indexterm>
Printers may be added automatically during logon script processing through the use of:

<screen>
&dosprompt;<userinput>rundll32 printui.dll,PrintUIEntry /?</userinput>
</screen>

See the documentation in the <ulink url="http://support.microsoft.com/default.asp?scid=kb;en-us;189105">Microsoft knowledgebase article 189105.</ulink>
</para>
</sect2>

</sect1>

</chapter>
